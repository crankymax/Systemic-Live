$(document).ready(function(){$(".combobox").select2({width:"300"}),$("#systems").click(function(){$("#phased-planet").val(""),$("#rvs").click(),K.loadSys($("#systems").val())}),$("#optimize").click(function(){K.optimize()}),$("#rvplot").highcharts({chart:{type:"scatter",zoomType:"xy"},tooltip:{enabled:!1},legend:{enabled:!1},title:{enabled:!1,text:""},xAxis:{title:{enabled:!0,text:"Time [Julian Days]"}},yAxis:{title:{enabled:!0,text:"Radial velocity [m/s]"}},series:[{color:COLORS[0],name:"",marker:{symbol:"circle"},visible:!1},{color:COLORS[1],name:"",marker:{symbol:"circle"},visible:!1},{color:COLORS[2],name:"",marker:{symbol:"circle"},visible:!1},{color:COLORS[3],name:"",marker:{symbol:"circle"},visible:!1},{color:COLORS[4],name:"",marker:{symbol:"circle"},visible:!1},{color:COLORS[5],name:"",marker:{symbol:"circle"},visible:!1},{color:"black",type:"line",name:"RV signal",marker:{enabled:!1}}]}),$("#psplot").highcharts({chart:{type:"line",zoomType:"xy"},tooltip:{enabled:!0,formatter:function(){return"Period: "+Math.pow(10,this.x).toFixed(2)+", power: "+this.y.toFixed(2)+"<br>Estimated false alarm probability: "+K.getFAPforPeriod(this.x).toPrecision(5)}},legend:{enabled:!1},title:{enabled:!1,text:""},xAxis:{title:{enabled:!0,text:"Period [d]"},labels:{formatter:function(){return Math.pow(10,this.value).toFixed(2)}}},yAxis:{title:{enabled:!0,text:"Power"},min:0},series:[{color:"black",type:"line",name:"Power",marker:{enabled:!1}},{color:"black",type:"line",lineWidth:1,dashStyle:"Dot",name:"black",marker:{enabled:!1,states:{hover:!1}},enableMouseTracking:!1},{color:"black",type:"line",lineWidth:1,dashStyle:"Dot",name:"FAP (10^-2)",marker:{enabled:!1,states:{hover:!1}},enableMouseTracking:!1},{color:"black",type:"line",lineWidth:1,dashStyle:"Dot",name:"FAP (10^-3)",marker:{enabled:!1,states:{hover:!1}},enableMouseTracking:!1}]}),$("#rvtabs a").click(function(e){e.preventDefault();var option=$(e.target).attr("href");return"#phased"==option&&0==K.getNplanets()?void alert("Add a planet first."):($(this).tab("show"),$("#phased-toolbox").css("display","#phased"==option?"block":"none"),void K.setRVPlot($(e.target).attr("href")))}),$("#addPlanet").click(function(){K.addPlanet()}),$("#removePlanet").click(function(){K.removePlanet()}),$("#integrated").click(function(){$("#rv").click(),$("#phased").attr("enabled",!$(this).is(":checked")),K.setIntegrated($(this).is(":checked"))}),$("#stop").click(function(){K.stop()});for(var i=1;MAX_PLANETS>=i;i++)for(var j=0;MAX_ELEMENTS>j;j++){var s=$("#elementSlider_"+i+"_"+j);s.attr("min",EL_MIN_MAX[j][0]),s.attr("max",EL_MIN_MAX[j][1]),s.attr("step",.05),function(slider,timeout,i,j){var timer,trig=function(){K.refresh(["psplot"])};slider.bind("change",function(){timer&&clearTimeout(timer),timer=setTimeout(trig,timeout);var v=parseFloat(this.value);(0==j||1==j)&&(v=Math.pow(10,v)),K.setElement(i,j,v,!1)})}(s,1e3,i,j);var t=$("#element_"+i+"_"+j);t.keyup(function(i,j){return function(e){13==e.keyCode&&(e.preventDefault(),K.setElement(i,j,parseFloat(this.value)))}}(i,j)),t.blur(function(){K.refresh("elements")})}for(var i=0;MAX_SETS>i;i++){var l=$("#offsetLabel_"+i);l.css("color",COLORS[i]);var s=$("#offsetSlider_"+i);s.attr("min",-VOMAX),s.attr("max",VOMAX),s.attr("step",.05),function(slider,timeout,i){var timer,trig=function(){K.refresh(["psplot"])};slider.bind("change",function(){timer&&clearTimeout(timer),timer=setTimeout(trig,timeout);var v=parseFloat(this.value);K.setParam(i,v,!1)})}(s,2e3,i);var t=$("#offset_"+i);t.keyup(function(i){return function(e){13==e.keyCode&&(e.preventDefault(),K.setParam(i,parseFloat(this.value),!0))}}(i)),t.blur(function(){K.refresh("params")})}for(var help_ids=["help_top","help_rvplot","help_psplot","help_statistics","help_offsets","help_planets","help_orbit"],i=0;i<help_ids.length;i++)$("#"+help_ids[i]).popover({title:"Help",html:!0,placement:"auto top",content:helpdoc[help_ids[i]]});$("#zoomIn").click(function(){K.zoomInOut(1)}),$("#zoomOut").click(function(){K.zoomInOut(-1)}),$("#share").click(function(){this.select()}),$("#phased-planet").val(""),$("#phased-planet").change(function(){var p=+$("#phased-planet").val();console.log("Phased planet: "+p),K.getNplanets()<p?(alert("There is no planet "+p+"."),$("#phased-planet").val("")):K.setPhasedPlanet(p)}),K.init(),_.parameter("sys")?($("#systems").select2("val",_.parameter("sys")),_.defer(function(){K.loadFromURL()})):K.loadSys("14Her.sys")});